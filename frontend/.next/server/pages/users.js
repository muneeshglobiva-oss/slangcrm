"use strict";(()=>{var e={};e.id=892,e.ids=[892,660],e.modules={3915:(e,r,t)=>{t.r(r),t.d(r,{config:()=>h,default:()=>p,getServerSideProps:()=>b,getStaticPaths:()=>g,getStaticProps:()=>x,reportWebVitals:()=>f,routeModule:()=>N,unstable_getServerProps:()=>S,unstable_getServerSideProps:()=>w,unstable_getStaticParams:()=>v,unstable_getStaticPaths:()=>j,unstable_getStaticProps:()=>y});var s={};t.r(s),t.d(s,{default:()=>m});var a=t(7093),l=t(5244),d=t(1323),o=t(5388),i=t.n(o),n=t(1103),c=t(997),u=t(6689);function m({user:e}){let[r,t]=(0,u.useState)([]),[s,a]=(0,u.useState)(!0),[l,d]=(0,u.useState)(""),[o,i]=(0,u.useState)(!1),[n,m]=(0,u.useState)(null),[p,x]=(0,u.useState)({name:"",email:"",role:"user",password:""});(0,u.useEffect)(()=>{e&&"admin"===e.role&&g()},[e]);let g=async()=>{try{let e=localStorage.getItem("token"),r=await fetch("/api/users",{headers:{Authorization:`Bearer ${e}`}});if(!r.ok)throw Error("Failed to fetch users");let s=await r.json();t(s)}catch(e){d(e.message)}finally{a(!1)}},b=async e=>{e.preventDefault();try{let e=localStorage.getItem("token"),r=n?`/api/users/${n.id}`:"/api/users";if(!(await fetch(r,{method:n?"PUT":"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(p)})).ok)throw Error("Failed to save user");i(!1),m(null),x({name:"",email:"",role:"user",password:""}),g()}catch(e){d(e.message)}},h=e=>{m(e),x({name:e.name,email:e.email,role:e.role,password:""}),i(!0)},f=async e=>{if(confirm("Are you sure you want to delete this user?"))try{let r=localStorage.getItem("token");if(!(await fetch(`/api/users/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${r}`}})).ok)throw Error("Failed to delete user");g()}catch(e){d(e.message)}};return e&&"admin"!==e.role?c.jsx("div",{className:"p-8 text-center text-red-600",children:"Access denied. Admin privileges required."}):s?c.jsx("div",{className:"p-8 text-center",children:"Loading..."}):l?(0,c.jsxs)("div",{className:"p-8 text-center text-red-600",children:["Error: ",l]}):(0,c.jsxs)("div",{className:"p-8",children:[c.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Manage Users"}),c.jsx("button",{onClick:()=>{m(null),x({name:"",email:"",role:"user",password:""}),i(!0)},className:"mb-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Add New User"}),o&&(0,c.jsxs)("form",{onSubmit:b,className:"mb-8 p-4 border border-gray-300 rounded",children:[c.jsx("h2",{className:"text-xl font-semibold mb-4",children:n?"Edit User":"Add New User"}),(0,c.jsxs)("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name:"}),c.jsx("input",{type:"text",value:p.name,onChange:e=>x({...p,name:e.target.value}),required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})]}),(0,c.jsxs)("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email:"}),c.jsx("input",{type:"email",value:p.email,onChange:e=>x({...p,email:e.target.value}),required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})]}),(0,c.jsxs)("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Role:"}),(0,c.jsxs)("select",{value:p.role,onChange:e=>x({...p,role:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",children:[c.jsx("option",{value:"user",children:"User"}),c.jsx("option",{value:"admin",children:"Admin"})]})]}),(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:["Password ",n?"(leave blank to keep current)":"",":"]}),c.jsx("input",{type:"password",value:p.password,onChange:e=>x({...p,password:e.target.value}),required:!n,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})]}),c.jsx("button",{type:"submit",className:"mr-2 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:n?"Update":"Create"}),c.jsx("button",{type:"button",onClick:()=>i(!1),className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"Cancel"})]}),(0,c.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[c.jsx("thead",{children:(0,c.jsxs)("tr",{style:{background:"#f8f9fa"},children:[c.jsx("th",{style:{padding:"0.75rem",textAlign:"left",border:"1px solid #dee2e6"},children:"Name"}),c.jsx("th",{style:{padding:"0.75rem",textAlign:"left",border:"1px solid #dee2e6"},children:"Email"}),c.jsx("th",{style:{padding:"0.75rem",textAlign:"left",border:"1px solid #dee2e6"},children:"Role"}),c.jsx("th",{style:{padding:"0.75rem",textAlign:"left",border:"1px solid #dee2e6"},children:"Created At"}),c.jsx("th",{style:{padding:"0.75rem",textAlign:"left",border:"1px solid #dee2e6"},children:"Actions"})]})}),c.jsx("tbody",{children:r.map(e=>(0,c.jsxs)("tr",{children:[c.jsx("td",{style:{padding:"0.75rem",border:"1px solid #dee2e6"},children:e.name}),c.jsx("td",{style:{padding:"0.75rem",border:"1px solid #dee2e6"},children:e.email}),c.jsx("td",{style:{padding:"0.75rem",border:"1px solid #dee2e6"},children:e.role}),c.jsx("td",{style:{padding:"0.75rem",border:"1px solid #dee2e6"},children:new Date(e.created_at).toLocaleDateString()}),(0,c.jsxs)("td",{style:{padding:"0.75rem",border:"1px solid #dee2e6"},children:[c.jsx("button",{onClick:()=>h(e),style:{padding:"0.25rem 0.5rem",background:"#ffc107",color:"#000",border:"none",borderRadius:"4px",cursor:"pointer",marginRight:"0.25rem"},children:"Edit"}),c.jsx("button",{onClick:()=>f(e.id),style:{padding:"0.25rem 0.5rem",background:"#dc3545",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Delete"})]})]},e.id))})]})]})}let p=(0,d.l)(s,"default"),x=(0,d.l)(s,"getStaticProps"),g=(0,d.l)(s,"getStaticPaths"),b=(0,d.l)(s,"getServerSideProps"),h=(0,d.l)(s,"config"),f=(0,d.l)(s,"reportWebVitals"),y=(0,d.l)(s,"unstable_getStaticProps"),j=(0,d.l)(s,"unstable_getStaticPaths"),v=(0,d.l)(s,"unstable_getStaticParams"),S=(0,d.l)(s,"unstable_getServerProps"),w=(0,d.l)(s,"unstable_getServerSideProps"),N=new a.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/users",pathname:"/users",bundlePath:"",filename:""},components:{App:n.default,Document:i()},userland:s})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},9816:e=>{e.exports=require("styled-jsx/style")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var r=require("../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[491,424,388,935],()=>t(3915));module.exports=s})();